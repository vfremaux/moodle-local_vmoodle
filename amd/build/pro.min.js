define(["jquery","core/log","core/config"],function(e,o,r){var i={component:"local_vmoodle",shortcomponent:"local_vmoodle",componentpath:"/local/vmoodle",init:function(){var r="#id_s_"+i.component+"_licensekey";e(r).bind("change",this.check_product_key),e(r).trigger("change"),o.debug("AMD Pro js initialized for "+i.component+" system")},check_product_key:function(){var o,c="#id_s_"+i.component+"_licensekey",t=e(this),n=t.val().replace(/-/g,""),a=n.substr(0,14),m=n.substr(14,2),s=i.checksum(a),l=' <img src="'+r.wwwroot+'/pix/i/valid.png">',p=' <img src="'+r.wwwroot+'/pix/i/warning.png">',g=' <img src="'+r.wwwroot+'/pix/i/invalid.png">',v=' <img src="'+r.wwwroot+'/pix/i/ajaxloader.gif">';if(m===s){var h=r.wwwroot+"/"+i.componentpath+"/pro/ajax/services.php?";h+="what=license",h+="&service=check",h+="&customerkey="+t.val(),h+="&provider="+e("#id_s_"+i.component+"_licenseprovider").val(),e(c+" + img").remove(),e(c).after(v),e.get(h,function(r){r.match(/(SET|CHECK) OK/)?(o=r.match(/-\d+.*$/))?(e(c+" + img").remove(),e(c).after(p)):(e(c+" + img").remove(),e(c).after(l)):(e(c+" + img").remove(),e(c).after(g))},"html")}else e(c+" + img").remove(),e(c).after(p)},checksum:function(e){var o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),r=o.length,i=e.split(""),c=0;for(var t in i)c+=i[t].charCodeAt(0);var n=Math.floor(c/r)%r;return""+o[c%r]+o[n]}};return i});